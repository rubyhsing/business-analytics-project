---
title: "HW4"
output: html_document
---

# 108304002_邢芳瑜_HW4

# 財務指標資料分析

## 分析財務報表，了解公司企業特性，以降維的方式，找出有意義的指標，衡量績優公司。

### 資料集：financialdata.csv

```{r}
finance <- read.csv("financialdata.csv")
library(ggfortify)
library(HDclassif)
library(reshape2)
library(tidyverse)
finance.df <- finance[,-1]%>%na.omit()
str(finance.df)

```

1. 以PCA或SPCA分析，找出每個主成份能解釋多少變異？大概需要多少個PC來解釋這筆資料？

藉由下面的PCA圖形分析，可以看到大約需要5個PC來解釋這筆資料，
從第一個到第五個PC各自能解釋約25%,22%,13%,8%,6%的變異，累積共能解釋75.6%的變異

```{r}
pca=prcomp(finance.df, center = TRUE, scale = TRUE) 
plot(pca, type="line")
avg_var = mean(pca$sdev^2) 
abline(h=avg_var, col="blue")
summary(pca)
```

2. 找出前三個主成份分別重點變數為何並解釋。

### PC1指標：營業費用率越低，表示公司的費用支出越小，獲利水平越高

### PC2指標：速動比例、流動比率越高，表示公司的資金越充沛，可用資產越多，而營業毛利率越高，表示企業「創造附加價值」的能力越高

### PC3指標：營收成長率高、資產週轉率高(資產使用效率越高)，表示公司的經營能力較佳

第一個PC的可解釋為*公司經營成本*，包含營業費用率(expense rate)

第二個PC可解釋為*資金充沛程度及創造附加價值能力*，包含速動比例(quick ratio),流動比例(current ratio),營業毛利率(gross margin rate)

第三個PC可解釋為*資源使用能力*，包含營收成長率(revenue growth rate),資產週轉率(asset turn over)

```{r}
ggplot(melt(pca$rotation[,1:3]), aes(Var2, Var1)) +
  geom_tile(aes(fill = value), colour = "white") +
  scale_fill_gradient2(low = "firebrick4", high = "steelblue",
                       mid = "white", midpoint = 0) +
  guides(fill=guide_legend(title="Coefficient")) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        axis.title = element_blank())
```

3. 找出適合投資的公司。

規則：找到與PC1呈現負相關、PC2呈現正相關、PC3呈現正相關的變數，表示公司之經營能力較佳
```{r}
index<-which(pca$x[,1]<0 & pca$x[,2]>0 & pca$x[,3]>0)
finance$comp_id[index]
```
